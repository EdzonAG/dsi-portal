{% extends 'base.html' %}
{% block content %}
<div class="sheet">
  <a href="{{ url_for('index') }}" class="btn btn-secondary mt-3 mb-3">Volver al Menú Principal</a>

  <h2 class="mb-3">Editar PSP: {{ psp.name }}</h2> {# BACKEND: provee 'psp' o variables sueltas #}

  <div class="panel">
    {# BACKEND:
       - Ajusta 'credenciales.update_credentials' al endpoint real.
       - Asegúrate de pasar 'psp.id' en la URL (o usa la ruta actual).
       - Si usas CSRF, agrega el token correspondiente.
    #}
    <form method="post" action="{{ url_for('credenciales.update_credentials', psp_id=psp.id) }}">
      <div class="mb-3">
        <label for="id_psp" class="form-label">ID PSP</label>
        <input type="text" id="id_psp" name="id_psp"
               class="form-control"
               value="{{ psp.id }}"
               maxlength="4" pattern="^[a-zA-Z]*$"
               required readonly>
        <small class="form-text">El ID es único y no se edita.</small>
      </div>

      <div class="mb-3">
        <label for="name_psp" class="form-label">Nombre Completo</label>
        <input type="text" id="name_psp" name="name_psp"
               class="form-control"
               value="{{ psp.name }}" required>
      </div>

      <div class="mb-3">
        <label for="status_psp" class="form-label">Estado</label>
        <select id="status_psp" name="status_psp" class="form-select">
          <option value="activo"   {% if psp.valid in ['activo', True, 'True'] %}selected{% endif %}>Activo</option>
          <option value="inactivo" {% if psp.valid in ['inactivo', False, 'False'] %}selected{% endif %}>Inactivo</option>
        </select>
      </div>

      <div class="mb-3">
        <label for="expiration_date_psp" class="form-label">Fecha de Expiración</label>
        <input type="date" id="expiration_date_psp" name="expiration_date_psp"
               class="form-control"
               value="{{ psp.expiration_date.strftime('%Y-%m-%d') if psp.expiration_date else exp_date_value|default('') }}"
               required>
        {# BACKEND: si prefieres, calcula 'exp_date_value' = 'YYYY-MM-DD' y pásalo ya formateado #}
      </div>

      <div class="d-flex gap-2">
        <button type="submit" class="btn btn-success">Guardar Cambios</button>
        <a href="{{ url_for('credenciales.credenciales_home') }}" class="btn btn-secondary">Cancelar</a>
      </div>
    </form>
  </div>
</div>
{% endblock %}
